<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IELTS Guided Writing Task</title>

  <!-- Google Fonts: Poppins & Lato -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&family=Inter:wght@400;500&family=Source+Sans+Pro:wght@400;700&display=swap" rel="stylesheet">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><text x='0' y='14'>üìù</text></svg>" type="image/svg+xml" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- DaisyUI & Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Confetti.js -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

  <style>
    :root {
      /* New Color Palette */
      --primary-color: #1A73E8; /* Royal Blue */
      --secondary-color: #0D1B2A; /* Deep Navy */
      --accent-green: #00A884; /* Emerald Green */
      --accent-orange: #FF6B3C; /* Sunset Orange */
      --accent-gold: #F2C94C; /* Gold */
      --bg-color: #F7F9FC; /* Cool Grey */
      --text-color: #303030; /* Charcoal */
      --card-bg: #FFFFFF;
      --soft-sky-blue: #E3F0FF;
    }

    body {
      background: var(--bg-color);
      min-height: 100vh;
      font-family: 'Inter', sans-serif;
      color: var(--text-color);
      line-height: 1.6;
      font-size: 18px; /* Base font size for readability */
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      color: var(--secondary-color); /* Deep Navy for headings */
    }
    h1 { font-size: 42px; } h2 { font-size: 38px; } h4 { font-size: 28px; }
    p {
      color: var(--text-color);
    }

    /* ===== STICKY HEADER ===== */
    .sticky-header {
      position: sticky;
      top: 0;
      z-index: 1030;
      background-color: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      padding: 0.75rem 1.5rem;
    }
    .logo {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      color: var(--secondary-color);
      font-size: 1.25rem;
    }
    .step-indicator {
      font-family: 'Lato', sans-serif;
      font-size: 1rem;
      color: var(--text-color);
    }
    .progress-bar-container {
      width: 100%;
      background-color: #e9ecef;
      border-radius: 16px;
      height: 8px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background-color: var(--primary-color);
      border-radius: 16px;
      transition: width 0.4s ease-in-out;
    }

    /* ===== LOGIN CARD ===== */
    #login-section .card {
      border: none;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(15px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    #login-section .card:hover {
      box-shadow: 0 12px 30px rgba(0,0,0,0.2);
    }

    /* ===== WIZARD SECTION ===== */
    .wizard-step {
      display: none;
      animation: fadeIn 0.5s ease forwards;
      margin-top: 20px;
    }
    .wizard-step.active {
      display: block;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ===== CARD STYLING ===== */
    .card {
      border: none;
      border-radius: 16px;
      background: var(--card-bg);
      box-shadow: 0 8px 25px rgba(0,0,0,0.07);
      transition: all 0.3s ease;
      padding: 24px;
    }
    .card:hover {
      box-shadow: 0 8px 28px rgba(0,0,0,0.12);
    }

    /* ===== BUTTONS ===== */
    .btn {
      border-radius: 8px;
      font-weight: 700;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .btn:hover {
      transform: scale(1.03);
      box-shadow: 0 4px 15px rgba(0,0,0,0.15);
    }
    .btn-primary, .next-btn, #login-btn {
      background-color: var(--primary-color);
      border-color: var(--primary-color);
      color: #fff;
    }
    .btn-primary:hover, .next-btn:hover, #login-btn:hover {
      background-color: #1465cc; /* Darker Royal Blue */
      border-color: #1465cc;
    }
    .btn-success {
      background-color: var(--accent-green);
      border-color: var(--accent-green);
    }
    .prev-btn {
      background-color: #6c757d; /* Standard secondary color */
      border-color: #6c757d;
      color: #fff;
    }

    /* ===== TABLE ===== */
    .table thead {
      background-color: var(--primary-color);
      color: #fff;
    }
    .table-hover tbody tr:hover {
      background-color: var(--soft-sky-blue);
    }
    #step-3 .table td {
      vertical-align: middle;
      padding: 0.9rem 0.75rem;
    }

    /* ===== TIMER ===== */
    .timer-display {
      font-size: 3rem;
      font-weight: 700;
      color: var(--secondary-color);
    }

    @keyframes pulse-glow {
      0%, 100% {
        box-shadow: 0 0 20px rgba(26, 115, 232, 0.2);
      }
      50% {
        box-shadow: 0 0 35px rgba(26, 115, 232, 0.4);
      }
    }

    .timer-container {
      animation: pulse-glow 3s infinite ease-in-out;
      border-radius: 50%;
      padding: 1rem;
    }

    /* ===== NAV TABS ===== */
    .nav-tabs .nav-link.active {
      background: var(--primary-color);
      color: #fff;
      border-color: var(--primary-color);
    }
    .nav-tabs .nav-link {
      font-weight: 700;
    }

    /* ===== SPECIAL ELEMENTS ===== */
    .completion-feedback {
      color: #198754;
      font-weight: 700;
      display: none;
    }
    .reflection-checklist .form-check {
      padding: 0.5rem;
      border-radius: 8px;
      transition: background-color 0.2s ease;
    }
    .reflection-checklist .form-check:hover {
      background-color: #e9ecef;
    }
    .sample-text-card {
      border-left: 4px solid var(--accent-gold);
      background-color: #f8f9fa;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
    }
    /* Ensure Bootstrap tabs are visible when active, overriding potential conflicts */
    .tab-content > .tab-pane.active {
      display: block !important;
    }
    .alert-light {
      color: var(--text-color);
      background-color: var(--soft-sky-blue);
    }
    /* Ensure media players are visible */
    .media-player {
      min-height: 50px; /* Minimum height for audio player */
      background-color: #e9ecef; /* Light background to show its presence */
      border: 1px solid #dee2e6; /* Border to define its space */
    }
    video.media-player {
      min-height: 200px; /* More height for video player */
      display: block; /* Ensure video takes up full width */
    }

    .focus-overlay {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      display: flex; justify-content: center; align-items: center;
      z-index: 2000;
      transition: opacity .4s ease;
    }
    .focus-center { text-align:center; color:#fff; }
    #focus-timer-display {
      font-size: 6rem; font-weight: 700; letter-spacing:2px;
      color: var(--primary-color);
      text-shadow: 0 0 30px rgba(26, 115, 232, 0.6);
      animation: pulseTimer 1.2s ease-in-out infinite alternate;
    }
    @keyframes pulseTimer {
      from { transform: scale(1); opacity: .9; }
      to   { transform: scale(1.05); opacity: 1; }
    }

    /* ===== FOOTER ===== */
    footer {
      text-align: center;
      margin-top: 60px;
      padding: 20px;
      font-size: 0.9rem;
      color: var(--text-color);
      opacity: 0.8;
    }

    /* Vocabulary Tags */
    .tag {
      display: inline-block;
      padding: 0.2em 0.6em;
      font-size: 0.75em;
      font-weight: 700;
      line-height: 1;
      color: #fff;
      text-align: center;
      white-space: nowrap;
      vertical-align: baseline;
      border-radius: 0.25rem;
      margin-left: 8px;
    } /* Mapped to new color palette */
    .tag-noun { background-color: var(--primary-color); } /* Royal Blue */
    .tag-verb { background-color: var(--accent-green); } /* Emerald Green */
    .tag-adj { background-color: var(--accent-gold); color: var(--text-color);} /* Gold */

    .pronounce-btn {
      background: none;
      border: none;
      color: var(--primary-color);
      cursor: pointer;
      font-size: 1.2rem;
    }

    /* Vocabulary Card Grid */
    .vocab-card {
      background-color: var(--card-bg);
      border: 1px solid var(--soft-sky-blue);
      border-radius: 12px;
      padding: 1.25rem;
      height: 100%;
      transition: all 0.3s ease;
    }
    .vocab-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(26, 115, 232, 0.1);
      border-color: var(--primary-color);
    }
    .vocab-word {
      font-family: 'Poppins', sans-serif;
      font-size: 22px;
      color: var(--secondary-color);
    }
    .vocab-definition {
      font-family: 'Inter', sans-serif;
      font-weight: 500;
      color: var(--primary-color);
      margin: 0.5rem 0;
    }
  </style>
</head>
<body>

  <!-- LOGIN SECTION -->
  <div id="login-section">
    <div class="d-flex align-items-center justify-content-center min-vh-100" style="background: var(--secondary-color);">
      <div class="card text-center p-4 p-md-5" style="max-width: 450px;">
        <h1 class="mb-2">IELTS Guided Task</h1>
        <p class="text-muted mb-4">Enter the classroom password to begin.</p>
        <div class="form-floating mb-3">
          <input type="password" class="form-control" id="password-input" placeholder="Password">
          <label for="password-input">Password</label>
        </div>
        <button id="login-btn" class="btn btn-primary btn-lg w-100">Login</button>
        <div id="error-alert" class="alert alert-danger mt-3" style="display: none;">
          <i class="fas fa-exclamation-triangle me-2"></i>
          Incorrect password. Please try again.
        </div>
      </div>
    </div>
  </div>
  
  <!-- MAIN CONTENT -->
  <main id="wizard-section" style="display:none;">
    <header class="sticky-header">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <span class="logo">IELTS Guided Task</span>
        <span id="step-indicator" class="step-indicator">Step 1 of 7 | Task Overview</span>
      </div>
      <div class="progress-bar-container">
        <div id="progress-fill" class="progress-fill" style="width: 14%;"></div>
      </div>
    </header>

    <div class="container mt-4">
      <div class="row d-flex justify-content-center">
        <div class="col-lg-8 col-md-10 col-12">

          <!-- Step 1: Task Overview -->
          <div id="step-1" class="wizard-step active">
            <div class="card">
              <h2 class="mb-3" style="color: var(--primary-color);">Step 1: Task Overview</h2>
              <p>Choose your preferred format for a brief overview of how to approach this type of task.</p>
              <ul class="nav nav-tabs" id="overviewTab" role="tablist">
                <li class="nav-item" role="presentation">
                  <button class="nav-link active" id="audio-tab" data-bs-toggle="tab" data-bs-target="#audio-pane" type="button" role="tab" aria-controls="audio-pane" aria-selected="true">Audio</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="video-tab" data-bs-toggle="tab" data-bs-target="#video-pane" type="button" role="tab" aria-controls="video-pane" aria-selected="false">Video</button>
                </li>
              </ul>
              <div class="tab-content p-3 border border-top-0 rounded-bottom mb-3" id="overviewTabContent">
                <div class="tab-pane fade show active p-2" id="audio-pane" role="tabpanel" style="background-color: var(--soft-sky-blue);">
                  <audio controls class="w-100 media-player">
                    <source src="materials/week-20-fri[task1-audio].mp3" type="audio/mpeg">Your browser does not support the audio element.</source></audio>
                </div>
                <div class="tab-pane fade" id="video-pane" role="tabpanel">
                  <div class="ratio ratio-16x9">
                    <video controls class="w-100 rounded media-player">
                      <source src="materials/week-20-fri[task1-video].mp4" type="video/mp4">Your browser does not support the video tag.</source></video>
                  </div>
                </div>
              </div>
              <div class="d-flex align-items-center p-3 mt-3" style="border-left: 4px solid var(--accent-gold); background-color: #FFFBEB;">
                <i class="fas fa-lightbulb fa-lg me-3" style="color: var(--accent-gold);"></i>
                <p class="mb-0" style="font-family: 'Source Sans Pro', sans-serif;">Listen to the overview carefully before starting your plan.</p>
              </div>
              <p class="completion-feedback" id="media-completed">‚úÖ Completed! Move to the next step.</p>
              <div class="d-flex justify-content-end mt-4">
                <button class="btn btn-primary next-btn">Next &rarr;</button>
              </div>
            </div>
          </div>

          <!-- Step 2: Brainstorm -->
          <div id="step-2" class="wizard-step">
            <div class="card">
              <h2 class="mb-3" style="color: var(--primary-color);">Step 2: Brainstorm</h2>
              <div class="row g-4">
                <div class="col-lg-5">
                  <div class="p-3 rounded" style="background-color: var(--soft-sky-blue);">
                    <h6 class="alert-heading">Task 1 Question</h6>
                    <img src="materials/week-20-fri-wt-1-image.jpg" alt="Water usage charts" class="img-fluid rounded">
                    <p class="mt-2 small"><strong>Summarize the information by selecting and reporting the main features and make relevant comparisons.</strong></p>
                  </div>
                </div>
                <div class="col-lg-7 d-flex flex-column justify-content-center align-items-center text-center">
                  <h4 class="mb-3">6-Minute Focus Timer</h4>
                  <p>Use the timer to brainstorm ideas and structure your response. This helps practice time management.</p>
                  <button id="startTimerBtn" class="btn btn-success btn-lg mt-3">Start Timer</button>
                  <div id="focus-overlay" class="focus-overlay d-none">
                    <div class="focus-center">
                      <div id="focus-timer-display">6:00</div>
                      <div id="focus-message" class="mt-3 fw-bold text-light fs-4"></div>
                    </div>
                    <!-- Removed clock-tick audio element -->
                  </div>
                </div>
              </div>
              <div class="d-flex justify-content-between mt-4">
                <button class="btn btn-secondary prev-btn">&larr; Previous</button>
                <button class="btn btn-primary next-btn">Next &rarr;</button>
              </div>
            </div>
          </div>

          <!-- Step 3: Vocabulary Table -->
          <div id="step-3" class="wizard-step">
            <div class="card">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="mb-0" style="color: var(--primary-color);">Step 3: Key Vocabulary</h2>
                <select id="accent-select" class="form-select form-select-sm" style="width:140px;">
                  <option value="en-GB">UK Accent üá¨üáß</option>
                  <option value="en-IN">Indian Accent üáÆüá≥</option>
                </select>
              </div>
              <p>Review the key vocabulary for this task. Using a range of words is essential for a high score.</p>
              <div class="row mt-4">
                <!-- Vocabulary Card Template -->
                <div class="col-lg-6 mb-4">
                  <div class="vocab-card">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="vocab-word mb-0">Burgeoning <span class="tag tag-adj">adj</span></h5>
                      <button class="pronounce-btn speak-btn">üîä</button>
                    </div>
                    <p class="vocab-definition">Growing rapidly</p>
                    <p class="small text-muted" style="font-family: 'Source Sans Pro', sans-serif;"><em>The burgeoning interest in foreign education reflects global academic integration.</em></p>
                  </div>
                </div>
                <div class="col-lg-6 mb-4">
                  <div class="vocab-card">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="vocab-word mb-0">Far-reaching <span class="tag tag-adj">adj</span></h5>
                      <button class="pronounce-btn speak-btn">üîä</button>
                    </div>
                    <p class="vocab-definition">Having extensive impact</p>
                    <p class="small text-muted" style="font-family: 'Source Sans Pro', sans-serif;"><em>The far-reaching effects of international study influence economies and cultures alike.</em></p>
                  </div>
                </div>
                <div class="col-lg-6 mb-4">
                  <div class="vocab-card">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="vocab-word mb-0">Augment <span class="tag tag-verb">verb</span></h5>
                      <button class="pronounce-btn speak-btn">üîä</button>
                    </div>
                    <p class="vocab-definition">Enhance or increase</p>
                    <p class="small text-muted" style="font-family: 'Source Sans Pro', sans-serif;"><em>Studying abroad can augment one‚Äôs academic and interpersonal capabilities.</em></p>
                  </div>
                </div>
                <div class="col-lg-6 mb-4">
                  <div class="vocab-card">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="vocab-word mb-0">Alleviate <span class="tag tag-verb">verb</span></h5>
                      <button class="pronounce-btn speak-btn">üîä</button>
                    </div>
                    <p class="vocab-definition">Ease or lessen</p>
                    <p class="small text-muted" style="font-family: 'Source Sans Pro', sans-serif;"><em>Exposure to diverse societies can alleviate prejudice and narrowmindedness.</em></p>
                  </div>
                </div>
                <div class="col-lg-6 mb-4">
                  <div class="vocab-card">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="vocab-word mb-0">Adverse <span class="tag tag-adj">adj</span></h5>
                      <button class="pronounce-btn speak-btn">üîä</button>
                    </div>
                    <p class="vocab-definition">Negative or harmful</p>
                    <p class="small text-muted" style="font-family: 'Source Sans Pro', sans-serif;"><em>Students might face adverse mental effects due to homesickness and cultural stress.</em></p>
                  </div>
                </div>
                <div class="col-lg-6 mb-4">
                  <div class="vocab-card">
                    <div class="d-flex justify-content-between align-items-center">
                      <h5 class="vocab-word mb-0">Brain drain <span class="tag tag-noun">noun</span></h5>
                      <button class="pronounce-btn speak-btn">üîä</button>
                    </div>
                    <p class="vocab-definition">Migration of skilled professionals</p>
                    <p class="small text-muted" style="font-family: 'Source Sans Pro', sans-serif;"><em>Excessive brain drain can weaken a nation‚Äôs developmental progress.</em></p>
                  </div>
                </div>
                <!-- Add more cards as needed -->
              </div>
              <div class="d-flex justify-content-between mt-4">
                <button class="btn btn-secondary prev-btn">&larr; Previous</button>
                <button class="btn btn-primary next-btn">Next &rarr;</button>
              </div>
            </div>
          </div>

          <!-- Step 4: Plan Introduction & Conclusion -->
          <div id="step-4" class="wizard-step">
            <div class="card">
              <h2 class="mb-3" style="color: var(--primary-color);">Step 4: Plan Introduction & Overview</h2>
              <p>Review these sample introductions and overviews. Notice how they paraphrase the prompt and state the main trends.</p>
              <div class="row g-4 mt-2">
                <div class="col-lg-6">
                  <h5 class="mb-3">Sample Introductions</h5>
                  <div class="sample-text-card">
                    <h6>Sample 1</h6>
                    <p class="small">The pie chart illustrates the global distribution of water consumption across three sectors ‚Äî agriculture, domestic use, and industry, while the bar chart compares how these same categories of water were utilised in China, India, New Zealand, and Canada in the year 2000, measured in percentages.</p>
                  </div>
                  <div class="sample-text-card">
                    <h6>Sample 2</h6>
                    <p class="small">The pie chart details the global distribution of water consumption across three sectors‚Äîagriculture, domestic use and industry‚Äîwhereas the accompanying bar chart contrasts the proportional use of water within the same categories across China, India, New Zealand and Canada in 2000, scaled in percentages.</p>
                  </div>
                </div>
                <div class="col-lg-6">
                  <h5 class="mb-3">Sample Overviews</h5>
                  <div class="sample-text-card">
                    <h6>Sample 1</h6>
                    <p class="small">Overall, agriculture dominated global water use, and the same pattern was evident in China and India, whereas Canada and New Zealand allocated a significantly larger proportion of water to industrial and domestic purposes. Industries consumed the lowest share globally, but domestic use was the least significant sector in both China and India.</p>
                  </div>
                  <div class="sample-text-card">
                    <h6>Sample 2</h6>
                    <p class="small">Overall, water usage at the global level was heavily skewed towards agricultural activities, and a similar pattern was evident in China and India. In sharp contrast, Canada and New Zealand indicated more diversified consumption, with significantly greater emphasis on domestic and industrial utilisation. Notably, industry accounted for the smallest global share, while agriculture dominated national patterns in two of the four countries.</p>
                  </div>
                </div>
              </div>
              <div class="d-flex justify-content-between mt-4">
                <button class="btn btn-secondary prev-btn">&larr; Previous</button>
                <button class="btn btn-primary next-btn">Next &rarr;</button>
              </div>
            </div>
          </div>

          <!-- Step 5: Plan Body Paragraph 1 -->
          <div id="step-5" class="wizard-step">
            <div class="card">
              <h2 class="mb-3" style="color: var(--primary-color);">Step 5: Plan Body Paragraph 1</h2>
              <p>Focus on agriculture and the major contrasts between the countries.</p>
              <div class="sample-text-card">
                <h5>Body Paragraph 1 ‚Äî Bullet Points (Agriculture Focus & Major Contrasts)</h5>
                <ul class="list-unstyled">
                  <li>‚Ä¢ Worldwide, agriculture constituted a dominant 70%, far surpassing domestic (8%) and industrial usage (22%).</li>
                  <li>‚Ä¢ India showed an extreme agricultural reliance, with 92% of its water directed to farming ‚Äî the highest among all countries.</li>
                  <li>‚Ä¢ China, while less pronounced, still allocated a substantial 69% to agriculture, reflecting similar regional dependency.</li>
                  <li>‚Ä¢ New Zealand used 44% for agriculture, indicating a far more balanced distribution than either Asian nation.</li>
                  <li>‚Ä¢ Canada, at just 8%, recorded the lowest agricultural allocation, representing a complete reversal of India‚Äôs pattern.</li>
                </ul>
              </div>
              <div class="d-flex justify-content-between mt-4">
                <button class="btn btn-secondary prev-btn">&larr; Previous</button>
                <button class="btn btn-primary next-btn">Next &rarr;</button>
              </div>
            </div>
          </div>

          <!-- Step 6: Plan Body Paragraph 2 -->
          <div id="step-6" class="wizard-step">
            <div class="card">
              <h2 class="mb-3" style="color: var(--primary-color);">Step 6: Plan Body Paragraph 2</h2>
              <p>Detail the industrial and domestic usage, highlighting the remaining contrasts.</p>
              <div class="sample-text-card">
                <h5>Body Paragraph 2 ‚Äî Bullet Points (Industry + Domestic + Remaining Contrasts)</h5>
                <ul class="list-unstyled">
                  <li>‚Ä¢ Industry, which represented 22% globally, was exceptionally dominant in Canada (80%), making it the most industrial-focused country in the dataset.</li>
                  <li>‚Ä¢ China mirrored the global industrial average, also at 22%, whereas New Zealand (10%) and India (3%) showed minimal industrial utilisation.</li>
                  <li>‚Ä¢ For domestic usage, New Zealand (46%) allocated the largest share, more than quadruple India‚Äôs 5%, and substantially above Canada‚Äôs 12% and China‚Äôs 9%.</li>
                </ul>
              </div>
              <div class="d-flex justify-content-between mt-4">
                <button class="btn btn-secondary prev-btn">&larr; Previous</button>
                <button class="btn btn-primary next-btn">Next &rarr;</button>
              </div>
            </div>
          </div>

          <!-- Step 7: Download PDF & Quiz -->
          <div id="step-7" class="wizard-step">
            <div class="card">
              <div class="text-center p-lg-5">
                <i class="fas fa-check-circle fa-5x mb-4" style="color: var(--accent-green);"></i>
                <h1 class="display-4" style="color: var(--secondary-color);">Task Complete!</h1>
                <p class="lead text-muted">You have successfully finished the guided writing task.</p>
                <p>You can now take the quiz or review your work.</p>
                <div class="d-flex justify-content-center align-items-center gap-4 mt-4">
                  <a href="quiz.html" class="btn btn-primary btn-lg">Take the Quiz</a>
                  <a href="teacher-report.html" target="_blank" class="btn btn-info btn-lg text-white">Tutor Report</a>
                </div>
                <div class="mt-4">
                  <p class="small text-muted mb-1">Or scan to take the quiz on your mobile:</p>
                  <img src="materials/qrcode_todayieltstask.onrender.com.png" alt="QR Code for quiz" class="img-fluid border rounded shadow-sm" style="max-width: 120px;" onerror="this.style.display='none'">
                </div>
              </div>
              <div class="d-flex justify-content-between mt-4">
                <button class="btn btn-secondary prev-btn">&larr; Previous</button>
                <button class="btn btn-success" id="finish-btn">Return to Home</button>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </main>

  <!-- Hidden Teacher Report Section -->
  <div class="container mt-5" id="teacher-report-section" style="display: none;">
    <a href="teacher-report.html" target="_blank" class="btn btn-link">Open Full Report</a>
    <div class="card">
      <h4>Teacher Report</h4>
      <p>Weekly trends and analysis of student performance.</p>
      <div class="alert alert-primary">Average accuracy this week: <strong>84% (+5% vs last week)</strong></div>
      <div class="table-responsive">
        <table class="table table-bordered">
          <thead class="table-dark">
            <tr>
              <th>TASK ID</th>
              <th>CORRECT ANSWER</th>
              <th>INCORRECT ANSWER</th>
              <th>MISSED OPTION</th>
              <th>Commonly missed questions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>77:77:77:77:01:D</td>
              <td>15</td>
              <td>5</td>
              <td>B</td>
              <td>Q2 (Concessive Clauses)</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <footer>
    <p>¬© 2025 Today IELTS Task | Made by DAKSH | All Rights Reserved</p>
  </footer>

  <!-- Core JS Files -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <!-- jsPDF for PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const loginSection = document.getElementById('login-section');
      const wizardSection = document.getElementById('wizard-section');
      const loginBtn = document.getElementById('login-btn');
      const passwordInput = document.getElementById('password-input');
      const errorAlert = document.getElementById('error-alert');

      const steps = document.querySelectorAll('.wizard-step');
      const stepIndicator = document.getElementById('step-indicator');
      const progressFill = document.getElementById('progress-fill');
      const nextButtons = document.querySelectorAll('.next-btn');
      const prevButtons = document.querySelectorAll('.prev-btn'); 
      const finishBtn = document.getElementById('finish-btn');
      let currentStep = 0;
      const totalSteps = steps.length;

      const stepTitles = [
        "Task Overview",
        "Brainstorm",
        "Vocabulary Table",
        "Plan Introduction & Conclusion",
        "Plan Body Paragraph 1",
        "Plan Body Paragraph 2",
        "Final Review & Download"
      ];

      loginBtn.addEventListener('click', () => {
        if (passwordInput.value === 'VII I MMVI') {
          loginSection.style.display = 'none';
          wizardSection.style.display = 'block';
          errorAlert.style.display = 'none';
          showStep(currentStep);
        } else {
          errorAlert.style.display = 'block';
        }
      });

      function updateUI() {
        // Update step indicator text
        stepIndicator.textContent = `Step ${currentStep + 1} of ${totalSteps} | ${stepTitles[currentStep]}`;
        // Update progress bar
        const progressPercentage = ((currentStep + 1) / totalSteps) * 100;
        progressFill.style.width = `${progressPercentage}%`;
      }

      function showStep(stepIndex) {
        steps.forEach((step, index) => {
          step.classList.toggle('active', index === stepIndex);
        });
        currentStep = stepIndex;
        updateUI();
        // Trigger confetti on the last step
        if (currentStep === totalSteps - 1) {
          confetti({ particleCount: 150, spread: 90, origin: { y: 0.6 } });
        }
        window.scrollTo(0, 0);
      }

      nextButtons.forEach(button => {
        button.addEventListener('click', () => {
          if (currentStep < totalSteps - 1) {
            showStep(currentStep + 1);
          }
        });
      });

      prevButtons.forEach(button => {
        button.addEventListener('click', () => {
          if (currentStep > 0) {
            showStep(currentStep - 1);
          }
        });
      });

      finishBtn?.addEventListener('click', () => {
        showStep(0);
      });

      // --- Timer Logic ---
      const startTimerBtn = document.getElementById('startTimerBtn');
      const overlay = document.getElementById("focus-overlay");
      const focusTimer = document.getElementById("focus-timer-display");
      const focusMsg = document.getElementById("focus-message");
      const messages = [
        "Think about trends!",
        "What comparisons can you make?",
        "Note high & low points.",
        "Focus on data contrast!",
        "Link features logically.",
        "Finalize your main features!"
      ];

      function startTimer() {
        overlay.classList.remove("d-none");
        
        let t = 360; // 6 minutes
        let minuteIndex = 0;
        
        const timer = setInterval(() => {
          const m = Math.floor(t / 60).toString().padStart(2,'0');
          const s = (t % 60).toString().padStart(2,'0');
          focusTimer.textContent = `${m}:${s}`;
          if (t % 60 === 0 && minuteIndex < messages.length) {
            focusMsg.textContent = messages[minuteIndex++];
          }
          if (--t < 0) {
            clearInterval(timer);
            focusMsg.textContent = "Time‚Äôs up!";
            setTimeout(()=>overlay.classList.add("d-none"),1500);
          }
        }, 1000);
      }
      startTimerBtn?.addEventListener('click', startTimer);

      overlay.addEventListener("click", () => {
        overlay.classList.add("d-none");
        // Note: This doesn't stop the interval, it just hides the overlay.
        // For a full stop, you'd need to clear the interval here too.
      });

      let accent = 'en-GB';
      document.getElementById('accent-select').addEventListener('change', e => accent = e.target.value);

      document.querySelectorAll('.speak-btn').forEach(button => {
        button.addEventListener('click', () => {
          const wordToSpeak = button.parentElement.querySelector('.vocab-word').textContent.split(" ")[0];
          const utterance = new SpeechSynthesisUtterance(wordToSpeak);
          utterance.lang = accent;
          speechSynthesis.speak(utterance);
        });
      });

      // --- Media Completion Logic ---
      document.querySelectorAll('.media-player').forEach(player => {
        player.addEventListener('ended', () => {
          console.log(`Media player ${player.tagName} ended.`); // Log when media ends
          document.getElementById('media-completed').style.display = 'block';
        });
        player.addEventListener('error', (e) => {
          console.error(`Error loading media: ${player.currentSrc}`, e); // Log any media loading errors
        });
      });
    });
  </script>

</body>
</html>
